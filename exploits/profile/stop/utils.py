def bytes_to_long(x):
    return int(x.hex(), 16)

def split_message(x, w, t):
    x = bytes_to_long(x)
    mask = int('1'*w, 2)

    for _ in range(t):
        yield x & mask
        x >>= w

def split_signature(s, size):
    return [s[i:i+size] for i in range(0, len(s), size)]

def n_hash(x, h, n):
    x = b'\0'*(32 - len(x)) + x
    for _ in range(n):
        x = h(x).digest()
    return x